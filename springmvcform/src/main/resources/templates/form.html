<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>User Form</title>
</head>
<body>
<h2>Enter User Details</h2>
<form th:action="@{/submit}" th:object="${user}" method="post">
    Name: <input type="text" th:field="*{name}"/><br/>
    Email: <input type="email" th:field="*{email}"/><br/><br/>

    <div id="addresses">
        <div th:each="addr, iStat : *{addresses}">
            City: <input type="text" th:field="*{addresses[__${iStat.index}__].city}"/>
            State: <input type="text" th:field="*{addresses[__${iStat.index}__].state}"/><br/>
        </div>
    </div>

    <button type="button" onclick="addAddress()">+ Add Address</button><br/><br/>

    Phone 1: <input type="text" name="phones[0]"/><br/>
    Phone 2: <input type="text" name="phones[1]"/><br/><br/>

    <input type="submit" value="Submit"/>
</form>

<script>
    function addAddress() {
        const index = document.querySelectorAll('#addresses input').length / 2;
        const div = document.createElement('div');
        div.innerHTML =
            `City: <input type="text" name="addresses[${index}].city" />
             State: <input type="text" name="addresses[${index}].state" /><br/>`;
        document.getElementById("addresses").appendChild(div);
    }
</script>
</body>
</html>
